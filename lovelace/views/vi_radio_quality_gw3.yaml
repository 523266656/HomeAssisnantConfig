title: Radio Quality [GW 3]
icon: mdi:radio-tower
panel: true
cards:
  - type: vertical-stack
    cards:
      # Gateways
      - type: markdown
        content: "### Gateways:"
      - type: 'custom:flex-table-card'
        clickable: false
        entities:
          include: 
            - sensor.*_gateway
        columns:
          - data: friendly_name
            name: Friendly Name
            modify: 'x.replace(/ Gateway$/,"")'
          - data: network_pan_id
            name: Network PAN ID
          - data: radio_tx_power
            name: Radio TX Power
          - data: radio_channel
            name: Radio Channel
          - data: free_mem
            name: Memory Free
          - data: load_avg
            name: Load Avg
            modify: 'x.replace(/\|/g,", ")'
          - data: rssi
            name: RSSI
          - data: uptime
            name: Gateway Uptime
          - data: state
            name: Connected Since
            modify: 
              var dt = new Date(x);
              dt.toLocaleString(['ru-RU', 'en-US'])
        css:
          table+: 'padding-top: 15px;'
          'tbody tr:nth-child(even)': 'background-color: #a2542f6;'
          td.left: 'padding: 10px 10px 10px 10px'
          th.left: 'padding: 0px 0px 10px 10px'
      # ZigBee
      - type: markdown
        content: "### ZigBee:"
      - type: 'custom:flex-table-card'
        clickable: false
        entities:
          include: 
            - sensor.*_zigbee
        sort_by: ieee
        #max_rows: 20
        columns:
          - data: friendly_name
            name: Friendly Name
            modify: 'x.replace(/ Zigbee$/,"")'
          - data: ieee
            name: IEEE
            modify: (x+'').toLowerCase()
          - data: nwk
            name: NWK
            modify: (x+'').replace(/^0x/,"").toLowerCase()
          - data: parent
            name: Parent
            modify: (x+'').replace(/^0x/,"").toLowerCase()
          - data: type
            name: Type
            modify: (x+'').replace(/^-$/, "child device")
          - data: msg_received
            name: Received
            modify: x+''
          - data: msg_missed
            name: Missed
            modify: x+''
          - data: unresponsive
            name: Unresponsive
            modify: x+''
          - data: link_quality
            name: LQI
            modify: x+''
          - data: rssi
            name: RSSI
            modify: x+''
          - data: last_msg
            name: Last Message
            modify: x+''
          - data: state
            name: Last Seen
            modify: >
              var dt = new Date(0,0,0,0,0,0,(Date.now()-Date.parse(x)));
              isFinite(dt) ? dt.toTimeString().split(" ")[0] : ""
        css:
    #      thead th: 'align-content: center;'
          table+: 'padding-top: 15px;'
          'tbody tr:nth-child(even)': 'background-color: #a2542f6;'
          td.left: 'padding: 10px 10px 10px 10px'
          th.left: 'padding: 0px 0px 10px 10px'
      # Bluetooth
      - type: markdown
        content: "### Bluetooth:"
      - type: 'custom:flex-table-card'
        clickable: false
        entities:
          include: 
            - sensor.*_ble
        sort_by: mac
        #max_rows: 20
        columns:
          - data: friendly_name
            name: Friendly Name
            modify: 'x.replace(/ Ble$/,"")'
          - data: mac
            name: MAC
            modify: (x+'').replace(/(.{2}(?!$))/g,"$1:")
          - data: msg_received
            name: Received
            modify: x+''
          - data: state
            name: Last Seen
            modify: >
              var dt = new Date(0,0,0,0,0,0,(Date.now()-Date.parse(x)));
              isFinite(dt) ? dt.toTimeString().split(" ")[0] : ""
        css:
    #      thead th: 'align-content: center;'
          table+: 'padding-top: 15px;'
          'tbody tr:nth-child(even)': 'background-color: #a2542f6;'
          td.left: 'padding: 10px 10px 10px 10px'
          th.left: 'padding: 0px 0px 10px 10px'